<app-vendor-dashboard-header></app-vendor-dashboard-header>
<div class="dashboard_body vendor-message-main-body">
  <app-vendor-side-menu></app-vendor-side-menu>
  <div class="middle_vendor_dasboard">
    <div class="middle_content">
      <p class="lookingGuidelinesPara">Listing face masks? Follow the <a>guidelines</a></p>
      <div class="headingBox">
        <div class="whiteHeadingBox">
          <h3>Messages</h3>
          <p>Chat with your Faire customers</p>
        </div>
      </div>
      <div class="vendor_message_body">
        <div class="row positive-row">
            <div class="col-md-3 col-custom-width">
                <input type="text" name="" value="" placeholder="Search" [(ngModel)]="searchText">
                <span class="label-span">Show unread messages only</span>
                <div class="radioDiv">
                    <label class="switch" for="checkbox1">
                        <input type="checkbox" id="checkbox1" (change)="onRadioChange($event);"/>
                        <div class="slider round"></div>
                    </label>
                </div>
                <span class="label-span">Yes</span>
                <div class="message-box">
                    <ul class="message-list">
                        <li *ngFor="let item of sortedMemberList | filter:searchText; let i  = index;">
                            <div [ngClass]="activeChat == i ? 'row inbox-sec active read' : 'row inbox-sec'" (click)="showChatBoxFunction(item, i, item?.user_id);">
                                <div class="col-md-3 col-3 img-sec"><img [src]="item?.logo ? item?.logo : 'assets/images/user-chat-img.png'" alt=""></div>
                                <div class="col-md-9 col-9 text-sec">
                                    <h4>{{item?.user}} 
                                        <!-- <span>Bazar support</span> -->
                                    </h4>
                                    <p [ngClass]="item?.status == 0 ? 'unRead' : ''" *ngIf="item?.message">{{item?.message?.message?.length > 20 ? item?.message?.message.slice(0,20)+'...' : item?.message?.message }}</p>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="chatbox" *ngIf="chatbox">
                <div class="white-chat-box">
                    <div class="chat-header">
                        <span class="prev-inbox" (click)="hideChatBoxFunction();"><img src="assets/images/product_category_left_arrow2.svg" alt=""></span>
                        <div class="row align-items-center">
                            <!-- <div class="col-md-2 img-sec"><img src="assets/images/chat-main-user-img.png" alt=""></div> -->
                            <div class="col-md-2 img-sec"><img [src]="selectedChatDetails?.logo ? selectedChatDetails?.logo : 'assets/images/user-chat-img.png'" alt=""></div>
                            <div class="col-md-8 text-sec">
                                <h3>{{selectedChatDetails?.user}}</h3>
                                <a routerLink="/brand-invoices/new" [queryParams]="{retailer: selectedChatDetails?.retailer_key}">Create invoice</a>
                            </div>
                        </div>
                    </div>
                    <div class="chat-body">
                        <ul class="chat-list" #content>
                            <!-- <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/message-image.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Taylor</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li><span class="border-span"><span>Friday, 25 May</span></span></li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/user-chat-img.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Me</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/message-image.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Taylor</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/user-chat-img.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Me</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/message-image.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Taylor</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/user-chat-img.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Me</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/user-chat-img.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Me</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/message-image.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Taylor</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/user-chat-img.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Me</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="row">
                                    <div class="col-md-1 col-2 user-img"><img src="assets/images/message-image.png" alt=""></div>
                                    <div class="col-md-11 col-10 user-text">
                                        <h4>Taylor</h4>
                                        <p>Hello! Thank you for contacting Bazar, Lorem ipsum</p>
                                    </div>
                                </div>
                            </li> -->
                            <ng-container *ngFor="let item of allChatDetails; let i = index">
                                <li><span class="border-span"><span>{{item?.date}}</span></span></li>
                                <ng-container *ngFor="let childItem of item?.message; let i = index">
                                    <!-- Sender -->
                                    <!-- <li *ngIf="childItem?.recRole == 'retailer'" class="evenList"> -->
                                    <li *ngIf="childItem?.sender == user_id" class="evenList">
                                        <div class="row">
                                            <div class="col-md-1 col-2 user-img"><img [src]="childItem?.brandLogo" alt=""></div>
                                            <div class="col-md-11 col-10 user-text">
                                                <h4>You</h4>
                                                <p>{{childItem?.message}}</p>
                                            </div>
                                        </div>
                                    </li>
                                    <!-- End sender -->
                                    <li *ngIf="childItem?.sender != user_id" class="">
                                        <div class="row">
                                            <div class="col-md-1 col-2 user-img"><img src="assets/images/user-chat-img.png" alt=""></div>
                                            <div class="col-md-11 col-10 user-text">
                                                <h4>{{selectedChatDetails?.user}}</h4>
                                                <p>{{childItem?.message}}</p>
                                            </div>
                                        </div>
                                    </li>
                                </ng-container>
                            </ng-container>
                        </ul>
                    </div>
                    <div class="bottom-chat">
                        <textarea *ngIf="!messageOnSend" name="message" [(ngModel)]="message" id="" cols="" rows="" class="form-control" placeholder="Type a merssage..." (keydown.enter)="messageCreate(selectedChatDetails?.user_id);"></textarea>
                        <textarea *ngIf="messageOnSend" name="message" [(ngModel)]="message" id="" cols="" rows="" class="form-control" placeholder="Type a merssage..."></textarea>
                        <input *ngIf="message?.length == 0" type="button" name="" value="Send" class="btn btn-primary disabled">
                        <input *ngIf="message?.length > 0 && !messageOnSend" type="button" name="" value="Send" class="btn btn-primary" (keydown.enter)="messageCreate(selectedChatDetails?.user_id);" (click)="messageCreate(selectedChatDetails?.user_id);" >
                        <input *ngIf="message?.length > 0 && messageOnSend" type="button" name="" value="Send" class="btn btn-primary">
                    </div>
                </div>
            </div>
            <div class="chatbox chatbox2" *ngIf="!chatbox">
                <div class="white-chat-box">
                    <div class="chat-body">
                        <h1 style="text-align: center;">Select a conversation</h1>
                    </div>
                </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>

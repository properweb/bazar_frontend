<app-vendor-dashboard-header></app-vendor-dashboard-header>
<div class="dashboard_body">
  <app-vendor-side-menu></app-vendor-side-menu>
  <div class="middle_vendor_dasboard">
    <div class="middle_content">
      <p class="lookingGuidelinesPara">Listing face masks? Follow the <a>guidelines</a></p>
      <div class="headingBox">
        <div class="whiteHeadingBox">
          <h3>New Promotion</h3>
          <p><a routerLink="/brand-portal/promotions/" >Promotions</a></p>
        </div>
      </div>
      <div class="vendor_promotions_body">
        <h3>Promotion name</h3>
        <ul class="promForm1">
          <li>
            <label class="form-label">This is how your promotion will appear to retailers at checkout</label>
            <input type="text" name="" value="" class="form-control" onKeyPress="if(this.value.length==20) return false;" name="title" [(ngModel)]="title" maxlength="20" #titleVal >
            <span class="characterLimits">{{titleVal.value.length}}/20</span>
          </li>
        </ul>
      </div>
      <div class="vendor_promotions_body">
        <h3>Promotion dates</h3>
        <ul class="row dateForm1">
          <li class="col-lg-2 date-list">
            <div class="dp-hidden position-absolute">
              <input
                  name="datepicker"
                  class="form-control"
                  ngbDatepicker
                  #datepicker="ngbDatepicker"
                  [autoClose]="'outside'"
                  (dateSelect)="onDateSelection($event)"
                  [displayMonths]="2"
                  [dayTemplate]="t"
                  outsideDays="hidden"
                  [startDate]="fromDate!"
                  tabindex="-1"
                />
                <ng-template #t let-date let-focused="focused">
                  <span
                    class="custom-day"
                    [class.focused]="focused"
                    [class.range]="isRange(date)"
                    [class.faded]="isHovered(date) || isInside(date)"
                    (mouseenter)="hoveredDate = date"
                    (mouseleave)="hoveredDate = null"
                  >
                    {{ date.day }}
                  </span>
                </ng-template>
             </div>
            <div class="input-group">
              <input
                #dpFromDate
                class="form-control calnInput"
                placeholder="from"
                name="dpFromDate"
                [value]="formatter.format(fromDate)"
                (input)="fromDate = validateInput(fromDate, dpFromDate.value)"
                (click)="datepicker.toggle()"
                readonly
              />
            </div>
          </li>
          <li class="col-lg-1 custom_cal_lg"><span class="fromSpan">-</span></li>
          <li class="col-lg-2">
            <div class="input-group">
              <input
                #dpToDate
                class="form-control calnInput"
                placeholder="till"
                name="dpToDate"
                [value]="formatter.format(toDate)"
                (input)="toDate = validateInput(toDate, dpToDate.value)"
                (click)="datepicker.toggle()"
                readonly
              />
              <!-- <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()" type="button"></button> -->
            </div>
          </li>
        </ul>
      </div>
      <div class="vendor_promotions_body">
        <h3>Promotion eligibility</h3>
        <ul class="row promoForm2">
          <li class="col-lg-3">
            <label class="form-label">Who will you be promoting to?</label>
            <ul class="formDiv">
              <li><span class="radioLabel">All my customers
                <input type="radio" [value]="1" name="promotion_to" [(ngModel)]="promotion_to" >
                <span class="checkmark"></span> </span> </li>
              <li><span class="radioLabel">New customers only
                <input type="radio" [value]="2" name="promotion_to" [(ngModel)]="promotion_to"  checked="checked">
                <span class="checkmark"></span> </span></li>
              <li><span class="radioLabel">Returning customers only
                <input type="radio" [value]="3" name="promotion_to" [(ngModel)]="promotion_to" >
                <span class="checkmark"></span> </span></li>
            </ul>
          </li>
          <li class="col-lg-3">
            <label class="form-label">Where will this promotion be available?</label>
            <ul class="checkBoxList">
              <li *ngFor="let item of promotionCountryArry">
                <div class="form-check">
                  <input [value]="item.id" type="checkbox" class="form-check-input" (change)="promoCountryChange($event)" >
                  <label class="form-check-label">{{item?.country_name}}</label>
                </div>
              </li>
              
            </ul>
          </li>
        </ul>
      </div>
      <div class="vendor_promotions_body">
        <h3>Promotion details</h3>
        <ul class="row promoForm2">
          <li class="col-lg-4">
            <label class="form-label">Add tiers to create a "buy more, save more" promotion</label>
            <ul class="formDiv">
              <li><span class="radioLabel">1Tier
                <input type="radio" [value]="1" name="promotion_tier" [(ngModel)]="promotion_tier">
                <span class="checkmark"></span> </span> </li>
              <li><span class="radioLabel">2 Tiers
                <input type="radio" [value]="2" name="promotion_tier" [(ngModel)]="promotion_tier" >
                <span class="checkmark"></span> </span></li>
              <li><span class="radioLabel">3 Tier
                <input type="radio" [value]="3" name="promotion_tier" [(ngModel)]="promotion_tier">
                <span class="checkmark"></span> </span></li>
            </ul>
          </li>
          <li class="col-lg-4">
            <label class="form-label">What type of promotion will you offer?</label>
            <ul class="formDiv">
              <li><span class="radioLabel">% Off
                <input type="radio" [value]="1" name="promotion_offer_type" [(ngModel)]="promotion_offer_type">
                <span class="checkmark"></span> </span> </li>
              <li><span class="radioLabel">$ Off
                <input type="radio" [value]="2" name="promotion_offer_type" [(ngModel)]="promotion_offer_type" checked="checked">
                <span class="checkmark"></span> </span></li>
              <li><span class="radioLabel">Free Shipping
                <input type="radio" [value]="3" name="promotion_offer_type" [(ngModel)]="promotion_offer_type">
                <span class="checkmark"></span> </span></li>
            </ul>
          </li>
        </ul>
        <div class="row promoFormSec">
          <div class="col-lg-4">
            <ul class="promoForm3">
              <li>
                <label class="form-label">Qualifying Order Amount</label>
                <input type="number" name="order_amount" [(ngModel)]="order_amount" class="form-control input1" placeholder="">
                <span class="Span1">$</span> <span class="Span2">Order min: $50.00</span> </li>
              <li *ngIf="promotion_offer_type == 1">
                <label class="form-label">Discount Amount</label>
                <input type="text" name="" value="" class="form-control input2" placeholder="" name="discount_amount" [(ngModel)]="discount_amount">
                <span class="Span3">%</span> 
              </li>
              <li *ngIf="promotion_offer_type == 2">
                <label class="form-label">Discount Amount</label>
                <input type="text" name="discount_amount" [(ngModel)]="discount_amount" class="form-control input2" placeholder="">
                <span class="Span3">$</span> 
              </li>
              <li>
                <div class="form-check">
                  <input *ngIf="promotion_offer_type != 3" type="checkbox" class="form-check-input" name="offer_free_shipping" [(ngModel)]="offer_free_shipping" [checked]="promotion_offer_type == 3" >
                  <input *ngIf="promotion_offer_type == 3" type="checkbox" class="form-check-input" checked disabled >
                  <label class="form-check-label">Also offer free shipping</label>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <p class="faireSplPara">Faire covers the cost of shipping for all eligible Insider members. <a>Learn More</a></p>
      </div>
      <div class="vendor_promotions_body" *ngIf="type == 'PRODUCT' " >
        <h3>Discount amount</h3>
        <p>The discount will apply to all the products you add to the promotion, including variants like different sizes or colors</p>
        <div class="row discountFormSec">
          <div class="col-lg-4">
            <ul class="discountForm3">
              <li>
                <label class="form-label">Discount Amount</label>
                <input type="text" name="" value="" class="form-control input1" placeholder="">
                <span class="Span1">% off</span> </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="vendor_promotions_body" *ngIf="type == 'PRODUCT' " >
        <h3>Recommend Additional Products</h3>
        <p><span class="grayPara">Introduce your customers to new products or recommend items that complement their order. Customers will be able to add recommended products to their order when checking out. <a>View Example</a></span></p><br >
        <h3>Add products</h3>
        <ul class="row shopInfoList">
          <li class="col-lg-10 searchBox">
            <ng-autocomplete [data]="proData" [searchKeyword]="proKeyword" #autoComId placeholder="Select Option" (inputFocused)='onFocused($event)' [itemTemplate]="itemTemplate2" [notFoundTemplate]="notFoundTemplate2" class="common-autosearch invoice-search" id="ajkahfjdif"></ng-autocomplete>
            <ng-template #itemTemplate2 let-item>
              <!-- <div class="searchBox"> -->
                <a *ngIf="item.variations.length == 0" (click)="onAddingProduct(item)" >
                  <span class="imgBox" ><img src="assets/images/search-img.png" alt="" /></span>
                  <span class="productInfoTxt">
                    <h4 [innerHTML]="item.name">{{item.name}}</h4>
                    <p>SKU: AA234</p>
                  </span>
                  <span class="priceTag">${{item.price}}</span>
                  <span class="stockTag">{{item.stock}}</span>
                </a>
                <a *ngIf="item.variations.length > 0" (click)="settingVariation(item);openInvoiceProductModal(invoiceProductContent)">
                  <span class="imgBox" ><img src="assets/images/search-img.png" alt="" /></span>
                  <span class="productInfoTxt">
                    <h4 [innerHTML]="item.name">{{item.name}}</h4>
                    <p>SKU: AA234</p>
                  </span>
                  <span class="priceTag">${{item.price}}</span>
                  <span class="stockTag">{{item.stock}}</span>
                </a>
              <!-- </div> -->
            </ng-template>
            <ng-template #notFoundTemplate2 let-notFound >
                <div [innerHTML]="notFound"></div>
            </ng-template>
          </li>
        </ul>
        <ul class="row show_product_list">
          <li class="col-lg-2">
            <div class="border_box complete_border_box">
              <div class="imgDiv"> <img src="assets/images/no-revisions-Pu0sndkokuA-unsplash-1.png" alt="" /> <a class="deleteIcon"><i class="fa-solid fa-trash"></i></a> </div>
              <div class="txtDiv">
                <h4>Grey plate</h4>
                <p>$11.70</p>
              </div>
            </div>
          </li>
          <li class="col-lg-2">
            <div class="border_box"></div>
          </li>
          <li class="col-lg-2">
            <div class="border_box"></div>
          </li>
        </ul>
      </div>
      <div class="vendor_promotions2_body">
        <ul class="btnList">
          <li>
            <input type="button" name="" value="Cancel" class="btn draft_btn">
          </li>
          <li>
            <input *ngIf="!btnDis" type="submit" name="" (click)="addPromotion()" value="Save" class="btn publish_btn">
            <input *ngIf="btnDis" type="submit" name="" disabled value="Please wait..." class="btn publish_btn">
            <!-- <input type="submit" name="" value="Save" class="btn publish_btn disabled"> -->
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<ng-template #invoiceProductContent let-modal>
  <div class="modal-header">
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <div class="top-main-product">
      <table class="table">
        <tbody>
          <tr>
            <td><img src="assets/images/product-img.jpeg" alt=""></td>
            <td>7Up Drink 150mL (12 Pieces) سفن آب شراب غازي ١٥٠ مل ١٢ حبة</td>
          </tr>                    
        </tbody>
      </table>
    </div>
    <input type="text" class="form-control search_form" value="" placeholder="" />
    <div class="invoice-product-table_list">
      <table class="table">
        <tbody>
          <tr *ngFor="let item of setProductVariants" >
            <td><input class="form-check-input" type="checkbox" [value]="item.variation_id" (change)="onVarCheckBoxSelect($event, item)" [checked]="selectedProducts.includes(item) && true" ></td>
            <td><img [src]="item.img" alt=""></td>
            <td>{{item.name}}</td>
            <td>In stock</td>
            <td>$1.00</td>
          </tr>                   
        </tbody>
      </table>
    </div>
  </div>
  <div class="modal-footer">
    <a (click)="modal.dismiss('Cross click')" class="btn btn-primary btn-cancel">Cancel</a>
    <a (click)="modal.dismiss('Cross click')" class="btn btn-primary btn-add">Add Options</a>
  </div>
</ng-template>